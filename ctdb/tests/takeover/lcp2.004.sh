#!/bin/sh

. "${TEST_SCRIPTS_DIR}/unit.sh"

define_test "3 nodes, 1 -> all healthy, info logging"

export CTDB_TEST_LOGLEVEL=3

required_result <<EOF
${TEST_DATE_STAMP}1 [-121363] -> 192.168.20.253 -> 0 [+0]
${TEST_DATE_STAMP}1 [-105738] -> 192.168.20.251 -> 2 [+0]
${TEST_DATE_STAMP}1 [-88649] -> 192.168.21.253 -> 0 [+14161]
${TEST_DATE_STAMP}1 [-75448] -> 192.168.20.254 -> 2 [+15625]
${TEST_DATE_STAMP}1 [-59823] -> 192.168.20.250 -> 0 [+29786]
${TEST_DATE_STAMP}1 [-44198] -> 192.168.21.254 -> 2 [+28322]
192.168.21.254 2
192.168.21.253 0
192.168.21.252 1
192.168.20.254 2
192.168.20.253 0
192.168.20.252 1
192.168.20.251 2
192.168.20.250 0
192.168.20.249 1
EOF

simple_test 0,0,0 <<EOF
192.168.20.249 1
192.168.20.250 1
192.168.20.251 1
192.168.20.252 1
192.168.20.253 1
192.168.20.254 1
192.168.21.252 1
192.168.21.253 1
192.168.21.254 1
EOF
