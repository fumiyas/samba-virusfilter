#!/bin/sh

. "${TEST_SCRIPTS_DIR}/unit.sh"

define_test "3 nodes, 2 healthy"

required_result <<EOF
${TEST_DATE_STAMP}Deterministic IPs enabled. Resetting all ip allocations
${TEST_DATE_STAMP}Unassign IP: 192.168.21.253 from 1
${TEST_DATE_STAMP}Unassign IP: 192.168.20.253 from 1
${TEST_DATE_STAMP}Unassign IP: 192.168.20.250 from 1
192.168.21.254 0
192.168.21.253 0
192.168.21.252 2
192.168.20.254 0
192.168.20.253 2
192.168.20.252 2
192.168.20.251 0
192.168.20.250 0
192.168.20.249 2
EOF

simple_test 0,2,0 <<EOF
192.168.20.249 0
192.168.20.250 1
192.168.20.251 2
192.168.20.252 0
192.168.20.253 1
192.168.20.254 2
192.168.21.252 0
192.168.21.253 1
192.168.21.254 2
EOF
